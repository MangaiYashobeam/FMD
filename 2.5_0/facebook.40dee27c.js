var e,t;"function"==typeof(e=globalThis.define)&&(t=e,e=null),function(t,r,a,o,n){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof i[o]&&i[o],s=l.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function g(e,r){if(!s[e]){if(!t[e]){var a="function"==typeof i[o]&&i[o];if(!r&&a)return a(e,!0);if(l)return l(e,!0);if(c&&"string"==typeof e)return c(e);var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}m.resolve=function(r){var a=t[e][1][r];return null!=a?a:r},m.cache={};var u=s[e]=new g.Module(e);t[e][0].call(u.exports,m,u,u.exports,this)}return s[e].exports;function m(e){var t=m.resolve(e);return!1===t?{}:g(t)}}g.isParcelRequire=!0,g.Module=function(e){this.id=e,this.bundle=g,this.exports={}},g.modules=t,g.cache=s,g.parent=l,g.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]},Object.defineProperty(g,"root",{get:function(){return i[o]}}),i[o]=g;for(var u=0;u<r.length;u++)g(r[u]);if(a){var m=g(a);"object"==typeof exports&&"undefined"!=typeof module?module.exports=m:"function"==typeof e&&e.amd?e(function(){return m}):n&&(this[n]=m)}}({eZj0B:[function(e,t,r){var a=e("~common/browserMethods");console.log("Hello from the Facebook content script"),chrome.runtime.onMessage.addListener(async function(e){let{message:t,vehicle:r,localStorage:o,whereToPost:n}=e;"runFBScript"===t&&("FB Marketplace"===n&&(await (0,a.postToFbMarketplace)(r,o),console.log("Vehicle posted to Facebook Marketplace:",r)),("FB Groups"===n||"FB Page"===n)&&(await chrome.storage.local.set({insertableVehicleData:r}),console.log("Vehicle data stored for FB Groups/Page:",r)),console.log("Local storage data:",o))})},{"~common/browserMethods":"92Ssc"}],"92Ssc":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"isVinPresent",()=>I),a.export(r,"updateSoldVehiclesWithPresence",()=>P),a.export(r,"AIDescription",()=>E),a.export(r,"preparePromptForOpenAI",()=>$),a.export(r,"cleanLocalStorageObject",()=>_),a.export(r,"postToFbMarketplace",()=>T),a.export(r,"updateActiveTabUrl",()=>v),a.export(r,"updateCurrentPageUrl",()=>b),a.export(r,"setLocalStorage",()=>d),a.export(r,"getLocalStorage",()=>h),a.export(r,"tabMessage",()=>w),a.export(r,"runTimeMessage",()=>A),a.export(r,"setBlobStorage",()=>f),a.export(r,"getBlogStorage",()=>y),a.export(r,"getBlobFromImgUrl",()=>p),a.export(r,"asyncSleep",()=>S);var o=e("~utils/humanInteraction"),n=e("webextension-polyfill"),i=a.interopDefault(n),l=e("~utils/aiAttributes"),s=e("~utils/ai"),c=e("./imagesUpload");let g="social_auto_group",u=i.default.storage.local;async function m(e){return new Promise((t,r)=>{let a=new FileReader;a.onloadend=()=>t(a.result),a.readAsDataURL(e)})}let p=async e=>{let t=new AbortController,r=setTimeout(()=>t.abort(),6e3);try{let a=await fetch(e,{signal:t.signal,headers:{Accept:"image/*","Cache-Control":"no-cache"}});if(clearTimeout(r),!a.ok)throw Error(`Failed to fetch image from ${e}: ${a.status} ${a.statusText}`);let o=await a.blob();if(o.size>8388608)throw Error(`Image size exceeds 8 MB for ${e}`);return await m(o)}catch(t){if(clearTimeout(r),"AbortError"===t.name)throw Error(`Image fetch timeout for ${e}`);throw t}};async function d(e){await u.set({[g]:e})}async function h(){let e=await u.get();return e[g]}async function f(e){await u.set({imageBlog:e})}async function y(){let e=await u.get();return e.imageBlog}async function w(e){let t=await (0,i.default).tabs.query({active:!0});return await (0,i.default).tabs.sendMessage(t[0].id,{...e})}async function A(e){try{let t=await (0,i.default).runtime.sendMessage(e);return t}catch(e){throw console.error("Runtime message error:",e),e}}async function b(e){let t=await (0,i.default).tabs.query({active:!0});(0,i.default).tabs.update(t[0].id,{url:e})}let x=e=>{try{if("string"!=typeof e)return e?.toString()||"";return e?.replace(/\\|"|\\r/g,"")}catch(e){return console.error("Error cleaning string:",e),""}};async function v(e){let t=await (0,i.default).tabs.query({active:!0});await (0,i.default).tabs.update(t[0]?.id,{url:e}),await C(t[0]?.id)}let k=(e,t)=>{try{let r=Array.from(document.querySelectorAll(e));return r?.find(e=>e instanceof HTMLElement&&e?.innerText.trim()===t)}catch(e){return console.error("Error finding element:",e),null}};async function C(e){await S(.5);let t=await (0,i.default).tabs.get(e);if("loading"!=t.status)return e;await C(e)}async function M(e,t=3e4,r=500){let a=Date.now()+t;for(;Date.now()<a;){let t=document.querySelector(e);if(t)return t;await new Promise(e=>setTimeout(e,r))}return null}async function T(e,t){let r,a,n,g,u;let{Make:m,Model:p,Year:d,Price:h,Title:f,stock_number:y,Description:w,VIN:A,MileageValue:b,ImageUrls:v,Trim:C,ExteriorColor:T,InteriorColor:E,BodyStyle:_,Drivetrain:$,engine:P}=e,I="Seller Notes: ",O="",U={body_style:"Other",exterior_color:"Black",interior_color:"Black",fuel_type:"Gasoline"},N="";C&&(O=C);let j=k("label","Vehicle type");await M('[aria-label="Preview"]',3e4,500);let F=`Year: ${d}
Make: ${m}
Model: ${p}
Trim: ${O||"Not specified"}
Price: ${h}
Mileage: ${b}
VIN: ${A}
Stock Number: ${y||"Not specified"}
Exterior Color: ${T||"Not specified"}
Interior Color: ${E||"Not specified"}
Body Style: ${_||"Not specified"}
Drivetrain: ${$||"Not specified"}
Engine: ${P||"Not specified"}
Title: ${f}
Description: ${w||"Not provided"}`;t&&(r=t.vehicleCategory,g=t.shouldAddStockNumber,u=t.isAiDescription,I=t.description),I||(I=".");let D=await (0,i.default).storage.local.get("emoji");n=D.emoji?.replace(/\"/g,"")||"";let L=await (0,i.default).storage.local.get("mileUnit");a=L.mileUnit?.replace(/\"/g,"")||"Miles";let B=!0===u||"true"===u,R=`${f} 
 ${A} 
 ${O}
 ${I}`;(function(e){let t=e?.replace(/[\u00ae$&*()@]/g,"")?.replace(/(===+|----+)/g,"")?.replace(/\u00A0/g," ")?.replace(/\s+/g," ")?.trim();t?.replace(/,\s*/g,",\n")?.replace(/:\s*/g,":\n")?.replace(/\.\s*/g,".\n")?.replace(/\*\s*/g,"\n* ")?.replace(/======/g,"\n======")?.replace(/\s+======/g,"\n======")})(R);let V=function(e){if(!e)return"";console.log("Original Text:",JSON.stringify(e));let t=e.replace(/\\n/g,"\n");console.log("After Replacing Escaped Newlines with Actual Newlines:",JSON.stringify(t));let r=t.replace(/\s+/g," ");console.log("After Removing Extra Spaces:",JSON.stringify(r));let a=r.replace(/\n+/g,"\n").trim();return console.log("Final Cleaned Text:",JSON.stringify(a)),a}(R),q=`${d} ${m} ${p} ${O} for Sale

Looking for a great ${m}? Check out this ${d} ${m} ${p}!

- Price: ${h}
- Mileage: ${b}
- VIN: ${A}
- Stock Number: ${y||"N/A"}
${T?`- Exterior Color: ${T}`:""}
${E?`- Interior Color: ${E}`:""}
${P?`- Engine: ${P}`:""}
${$?`- Drivetrain: ${$}`:""}

Contact us for more information or to schedule a test drive!`;if(B)try{(N=await (0,s.generateAIDescription)(F))&&""!==N.trim()||(console.warn("[Marketplace] AI description was empty, using fallback"),N=q)}catch(e){console.error("[Marketplace] Error generating AI description:",e),N=q}else N=V||q;try{await (0,o.humanClick)(j),await S(.5);let e=k("span",x(r)||"Other");await (0,o.humanClick)(e),await (0,o.waitUserDelay)()}catch(e){console.error("[Marketplace] Error selecting vehicle type:",e)}try{let e=k("label","Year");await (0,o.humanClick)(e),await S(.5);let t=(d||"").toString().trim(),r=k("span",x(t)||"2022");await (0,o.humanClick)(r),await (0,o.waitUserDelay)()}catch(e){console.error("[Marketplace] Error selecting year:",e)}let G="";if("Car/Truck"===r){try{let e=await (0,l.extractAttributesFromDescription)(F);e&&(U={body_style:e.body_style||U.body_style,exterior_color:e.exterior_color||U.exterior_color,interior_color:e.interior_color||U.interior_color,fuel_type:e.fuel_type||U.fuel_type})}catch(e){console.error("[Car/Truck] Error extracting AI attributes:",e)}try{let e=k("label","Make");await (0,o.humanClick)(e),await S(.5);let t="";try{t=["SRT","MINI","CODA","BMW","GMC"].includes(m)?m:m?.charAt(0)?.toUpperCase()+m?.slice(1)?.toLowerCase()}catch(e){console.error("[Car/Truck] Error processing Make:",e)}let r=k("span",t||"Toyota");await (0,o.humanClick)(r),await (0,o.waitUserDelay)()}catch(e){console.error("[Car/Truck] Error selecting Make:",e)}try{let e=k("label","Vehicle condition");await (0,o.humanClick)(e),await S(.5);let t=k("span","Excellent");await (0,o.humanClick)(t),await (0,o.waitUserDelay)()}catch(e){console.error("[Car/Truck] Error selecting vehicle condition:",e)}try{let e=k("label","Mileage");console.log("[Car/Truck] Mileage label found:",!!e);let t="string"==typeof b?b.replace(",",""):b?.toString()||"0";await (0,o.humanTypeText)(e,x(t)||"0",{perCharMinMs:25,perCharMaxMs:70,longPauseProbability:.08})}catch(e){console.error("[Car/Truck] Error entering mileage:",e)}try{let e=k("label","Exterior color");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.exterior_color||"Black");if(t)await (0,o.humanClick)(t);else{console.warn("[Car/Truck] Exterior color option not found, trying fallback 'Black'");let e=k("span","Black");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Car/Truck] Error selecting exterior color:",e)}try{let e=k("label","Body style");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.body_style||"Other");if(t)await (0,o.humanClick)(t);else{console.warn("[Car/Truck] Body style option not found, trying fallback 'Other'");let e=k("span","Other");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Car/Truck] Error selecting body style:",e)}try{let e=k("label","Fuel type");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.fuel_type||"Gasoline");if(t)await (0,o.humanClick)(t);else{console.warn("[Car/Truck] Fuel type option not found, trying fallback 'Gasoline'");let e=k("span","Gasoline");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Car/Truck] Error selecting fuel type:",e)}try{let e=k("label","Interior color");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.interior_color||"Black");if(t)await (0,o.humanClick)(t);else{console.warn("[Car/Truck] Interior color option not found, trying fallback 'Black'");let e=k("span","Black");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("Error selecting interior color:",e)}G=`${p} ${O} ${n}`}else if("Motorcycle"===r){try{let e=await (0,l.extractAttributesFromDescription)(F);e&&(U={body_style:e.body_style||U.body_style,exterior_color:e.exterior_color||U.exterior_color,interior_color:e.interior_color||U.interior_color,fuel_type:e.fuel_type||U.fuel_type})}catch(e){console.error("[Motorcycle] Error extracting AI attributes:",e)}try{let e=k("label","Make");await (0,o.humanClick)(e),await S(.5);let t="";try{t=["BMW","KTM","MV Agusta","CFMoto"].includes(m)?m:m?.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("-")}catch(e){console.error("[Motorcycle] Error processing Make:",e),t=m}let r=k("span",t||"Other");if(r)await (0,o.humanClick)(r);else{console.warn("[Motorcycle] Make option not found, trying fallback 'Other'");let e=k("span","Other");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Motorcycle] Error selecting Make:",e)}try{let e=k("label","Exterior color");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.exterior_color||"Black");if(t)await (0,o.humanClick)(t);else{console.warn("[Motorcycle] Exterior color option not found, trying fallback 'Black'");let e=k("span","Black");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Motorcycle] Error selecting exterior color:",e)}try{let e=k("label","Fuel type");await (0,o.humanClick)(e),await S(.5);let t=k("span",U?.fuel_type||"Gasoline");if(t)await (0,o.humanClick)(t);else{console.warn("[Motorcycle] Fuel type option not found, trying fallback 'Gasoline'");let e=k("span","Gasoline");e&&await (0,o.humanClick)(e)}await (0,o.waitUserDelay)()}catch(e){console.error("[Motorcycle] Error selecting fuel type:",e)}G=`${p} ${O} ${n} ${b||0} ${a}`}else{try{let e=k("label","Make");await (0,o.humanTypeText)(e,x(m)||"n/a",{perCharMinMs:35,perCharMaxMs:90,longPauseProbability:.08})}catch(e){console.error("[Other] Error entering Make:",e)}G=`${p} ${O} ${n} ${b||0} ${a}`}try{let e=k("label","Model");await (0,o.humanTypeText)(e,x(G)||"n/a",{perCharMinMs:35,perCharMaxMs:90,longPauseProbability:.08})}catch(e){console.error("[Marketplace] Error entering Model:",e)}try{let e=k("label","Price");await (0,o.humanTypeText)(e,x(h)||"n/a",{perCharMinMs:35,perCharMaxMs:90,longPauseProbability:.08})}catch(e){console.error("Error entering Price:",e)}try{let e=k("label","Description"),t=g?`${N}
Stock Number: ${y}`:N;await (0,o.humanTypeText)(e,x(t)||"n/a",{perCharMinMs:15,perCharMaxMs:45,longPauseProbability:.05})}catch(e){console.error("Error entering Description:",e)}try{let e=v?.slice(0,20);await (0,c.uploadImagesFbEvent)(e)}catch(e){console.error("Error uploading images:",e)}}async function E(e,t){let r="",a=await $(e,t);a=a.replaceAll("title:","description").replaceAll("title","description").replaceAll("Title:","description").replaceAll("Title","description").replaceAll("TITLE","description");let o=await (0,i.default).storage.local.get("password"),n=o.password?.replace(/\"/g,"")||"",l={api_key:n,system_prompt:"You are a professional car description writer, generate concise and sales-focused descriptions",user_prompt:a,model:"gpt-4o-mini"};try{let e=await fetch("https://sag.gemquery.com/api/v1/generate-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),t=await e.json();t.success?r=t.text_response.trim():console.error("Failed to generate AI description:",t.error)}catch(e){console.error("Error during API call:",e)}return r}function S(e){return new Promise(t=>setTimeout(t,1e3*e))}function _(e){return{emoji:e?.emoji?.replace(/\"/g,""),imageBlog:e?.imageBlog,isAuthenticated:e?.isAuthenticated==="true",mileUnit:e?.mileUnit?.replace(/\"/g,""),password:e?.password?.replace(/\"/g,""),shouldAddStockNumber:e?.shouldAddStockNumber==="true",vehicleCategory:e?.vehicleCategory?.replace(/\"/g,""),description:e?.description?.replace(/\"/g,""),whereToPost:e?.whereToPost?.replace(/\"/g,""),isAiDescription:e?.isAiDescription==="true"}}async function $(e,t){try{let{shouldAddInstructions:r}=await (0,i.default).storage.local.get("shouldAddInstructions"),a=`Here is the vehicle information:
${e} Mileage: ${t}

Please write a simple, magazine-style article description for this vehicle. **Start with the year, make, and model**, then state the current mileage. **Highlight key features** that make this vehicle stand out. Keep it concise and engaging. Do not use any special characters or include the dealership name. Aim for about 80\u2013120 words.`;if("true"===r){let{description:e}=await (0,i.default).storage.local.get("description"),t=e?.replace(/"/g,"");if(t){let e=`${t}

${a}`;return e}}return a}catch(e){return console.error("Error in preparePromptForOpenAI:",e),"Error generating prompt"}}function P(e,t,r){let a=new Map;t?.forEach(e=>{e?.VIN&&a.set(e.VIN,e)});let o=e=>{if(!e)return e;let t=e.replace(/[^\d.-]/g,""),r=parseFloat(t);return isNaN(r)?e:`$${r.toLocaleString()}`},n=(e,t)=>{if(!t)return{priceChanged:!1,newPrice:null};let r=e?.price||e?.Price,a=t?.Price;if(!r||!a)return{priceChanged:!1,newPrice:null};let n=e=>"string"!=typeof e?e:e.replace(/[^\d.-]/g,""),i=n(r),l=n(a),s=i!==l;return{priceChanged:s,newPrice:s?o(a):null,oldPrice:s?o(r):null}};return r?e?.filter(e=>!a.has(e?.vin)):e?.map(e=>{let t=a.get(e?.vin),r=n(e,t);return{...e,present:a.has(e?.vin),...r}})}function I(e,t){return t?.some(t=>t?.vin===e)}},{"~utils/humanInteraction":"9KUoU","webextension-polyfill":"hkciQ","~utils/aiAttributes":"kmzlN","~utils/ai":"1AesJ","./imagesUpload":"138GT","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],"9KUoU":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"waitUserDelay",()=>l),a.export(r,"humanDelay",()=>s),a.export(r,"occasionalLongPause",()=>c),a.export(r,"performHumanNoise",()=>g),a.export(r,"humanClick",()=>m),a.export(r,"humanTypeText",()=>v),a.export(r,"findGroupComposerField",()=>E),a.export(r,"legacyTypeDescription",()=>_);let o=(e,t)=>Math.floor(e+Math.random()*(t-e+1)),n=e=>new Promise(t=>setTimeout(t,e)),i=async()=>{try{let{customInputDelaySeconds:e}=await chrome.storage.local.get("customInputDelaySeconds"),t=Number(e);if(!Number.isFinite(t)||t<=0)return 0;return 1e3*Math.min(Math.max(t,0),10)}catch{return 0}},l=async()=>{let e=await i();e>0&&await n(e)},s=async(e=150,t=600)=>{await n(o(e,t))},c=async(e=.18)=>{Math.random()<e&&await n(o(1e3,2e3))},g=async e=>{try{let t=o(-5,5),r=o(-30,30);window.scrollBy({left:t,top:r,behavior:"auto"});let a=Math.max(0,Math.min(window.innerWidth,Math.floor(window.innerWidth/2+o(-120,120)))),i=Math.max(0,Math.min(window.innerHeight,Math.floor(window.innerHeight/2+o(-120,120)))),l=o(1,3);for(let t=0;t<l;t++){let t=new MouseEvent("mousemove",{bubbles:!0,clientX:a+o(-8,8),clientY:i+o(-8,8)});(e||document.body)?.dispatchEvent(t),await n(o(20,60))}}catch{}},u=async e=>{try{e.scrollIntoView({block:"center",inline:"center"}),await s(120,280)}catch{}},m=async e=>{if(!e)return;await g(e),await u(e);let t=e.getBoundingClientRect?.()||{left:0,top:0,width:0,height:0},r=Math.floor(t.left+Math.max(1,t.width*Math.random())),a=Math.floor(t.top+Math.max(1,t.height*Math.random())),i=t=>e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,clientX:r,clientY:a,buttons:1}));i("pointerover"),await n(o(10,40)),i("mouseover"),await n(o(10,40)),i("pointerdown"),i("mousedown"),await n(o(40,120)),e.focus?.(),await n(o(30,90)),i("pointerup"),i("mouseup"),await n(o(20,80)),i("click"),await s(),await c(.08)},p=e=>!!e&&!0===e.isContentEditable,d=e=>{if(!e)return null;if(p(e)||"INPUT"===e.tagName||"TEXTAREA"===e.tagName)return e;let t=e.querySelector?.('input, textarea, [contenteditable="true"]');if(t)return t;if("LABEL"===e.tagName){let t=e.htmlFor;if(t){let e=document.getElementById(t);if(e)return e}}return null},h=(e,t)=>{let{set:r}=Object.getOwnPropertyDescriptor(e.__proto__,"value")||Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value")||Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,"value")||{};r?r.call(e,t):e.value=t,e.dispatchEvent(new Event("input",{bubbles:!0}))},f=e=>{let t=document.createRange();t.selectNodeContents(e),t.collapse(!1);let r=window.getSelection();r?.removeAllRanges(),r?.addRange(t)},y=(e,t,r)=>{let a=new KeyboardEvent(e,{bubbles:!0,cancelable:!0,key:t,code:1===t.length?`Key${t.toUpperCase()}`:t});r.dispatchEvent(a)},w=(e,t)=>{let r=new InputEvent("beforeinput",{bubbles:!0,cancelable:!0,data:t,inputType:"insertText"});e.dispatchEvent(r)},A=(e,t)=>{let r=new InputEvent("input",{bubbles:!0,cancelable:!1,data:t,inputType:"insertText"});e.dispatchEvent(r)},b=(e,t)=>{if(void 0!==e.value&&"INPUT"===e.tagName||void 0!==e.value&&"TEXTAREA"===e.tagName){y("keydown",t,e),w(e,t),h(e,(e.value||"")+t),y("keyup",t,e);return}if(p(e)){y("keydown",t,e),w(e,t);let r=window.getSelection(),a=r?.rangeCount?r.getRangeAt(0):document.createRange();if(a){a.collapse(!1);let e=document.createTextNode(t);a.insertNode(e),a.setStartAfter(e),a.setEndAfter(e),r?.removeAllRanges(),r?.addRange(a)}else e.appendChild(document.createTextNode(t)),f(e);A(e,t),y("keyup",t,e);return}},x=async e=>{await m(e),e.focus(),p(e)&&f(e),await s(80,180)},v=async(e,t,r)=>{try{let a=d(e)||e,i=a&&(d(a)||a);if(!i)return;await x(i),await c(.1);let s=Array.from((t??"").toString()),g=Math.max(5,r?.perCharMinMs??40),u=Math.max(g,r?.perCharMaxMs??120),m=Math.max(0,Math.min(1,r?.longPauseProbability??.12));for(let e=0;e<s.length;e++){let t=s[e];b(i,t),await n(o(g,u)),e>0&&e%o(7,14)==0&&await c(m)}await l()}catch{}},k='[role="dialog"] [role="textbox"][contenteditable="true"]',C=[k,'[contenteditable="true"][aria-label="Create a public post\u2026"]','[contenteditable="true"][aria-label="Create a public post..."]','[contenteditable="true"][aria-label="Create a public post"]','[contenteditable="true"][aria-label="Create post\u2026"]','[contenteditable="true"][aria-label="Create post..."]','[contenteditable="true"][aria-label="Create post"]','[contenteditable="true"][aria-label="Create a post"]','[contenteditable="true"][aria-label*="What\'s on your mind" i]','[contenteditable="true"][role="textbox"]','[role="textbox"][contenteditable="true"]','[contenteditable="true"][aria-multiline="true"]','[contenteditable="true"][data-lexical-editor]','[contenteditable="true"][data-contents="true"]'],M=['[aria-label="Create a public post"]','[aria-label="Create a public post\u2026"]','[aria-label="Create a public post..."]','[aria-label="Create post"]','[aria-label="Create post\u2026"]','[aria-label="Create post..."]','[aria-label="Create a post"]','[aria-label*="Create post" i]','[aria-label*="Create a post" i]'],T=e=>{if(!e)return!1;let t=e.getClientRects();return t.length>0&&t[0].width>0&&t[0].height>0},E=()=>{let e=document.querySelector(k);if(e&&T(e))return e;for(let e of C){let t=Array.from(document.querySelectorAll(e)),r=t.find(e=>e&&T(e)&&e.isContentEditable);if(r)return r}for(let e of M){let t=document.querySelector(e);if(t&&T(t)){let e=Array.from(t.querySelectorAll('[contenteditable="true"]')).find(e=>T(e));if(e)return e}}let t=Array.from(document.querySelectorAll('[contenteditable="true"]')),r=t.find(e=>e&&T(e)&&e.isContentEditable);if(r)return r;let a=document.activeElement;return a&&a.isContentEditable?a:null},S=(e,t)=>{if(!e)return!1;try{e.focus();let r=window.getSelection(),a=document.createRange();a.selectNodeContents(e),r?.removeAllRanges(),r?.addRange(a),document.execCommand("selectAll",!1,"");let o=document.execCommand("insertText",!1,t);return o||(a.deleteContents(),a.insertNode(document.createTextNode(t)),r?.removeAllRanges()),e.dispatchEvent(new Event("input",{bubbles:!0})),e.dispatchEvent(new Event("change",{bubbles:!0})),!0}catch(e){return console.error("legacyInsertText failed:",e),!1}},_=async(e,t)=>{try{await m(e)}catch{}let r=S(e,t);if(!r){await v(e,t,{perCharMinMs:20,perCharMaxMs:60,longPauseProbability:.04});return}await l()}},{"@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],cHUbl:[function(e,t,r){r.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},r.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.exportAll=function(e,t){return Object.keys(e).forEach(function(r){"default"===r||"__esModule"===r||t.hasOwnProperty(r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})}),t},r.export=function(e,t,r){Object.defineProperty(e,t,{enumerable:!0,get:r})}},{}],hkciQ:[function(t,r,a){var o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,o=function(e){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw Error("This script should only be loaded in a browser extension.");globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id?e.exports=globalThis.browser:e.exports=(e=>{let t={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(t).length)throw Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}let a=e=>e&&"object"==typeof e&&"function"==typeof e.then,o=(t,r)=>(...a)=>{e.runtime.lastError?t.reject(Error(e.runtime.lastError.message)):r.singleCallbackArg||a.length<=1&&!1!==r.singleCallbackArg?t.resolve(a[0]):t.resolve(a)},n=e=>1==e?"argument":"arguments",i=(e,t)=>function(r,...a){if(a.length<t.minArgs)throw Error(`Expected at least ${t.minArgs} ${n(t.minArgs)} for ${e}(), got ${a.length}`);if(a.length>t.maxArgs)throw Error(`Expected at most ${t.maxArgs} ${n(t.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((n,i)=>{if(t.fallbackToNoCallback)try{r[e](...a,o({resolve:n,reject:i},t))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),r[e](...a),t.fallbackToNoCallback=!1,t.noCallback=!0,n()}else t.noCallback?(r[e](...a),n()):r[e](...a,o({resolve:n,reject:i},t))})},l=(e,t,r)=>new Proxy(t,{apply:(t,a,o)=>r.call(a,e,...o)}),s=Function.call.bind(Object.prototype.hasOwnProperty),c=(e,t={},r={})=>{let a=Object.create(null),o=Object.create(e);return new Proxy(o,{has:(t,r)=>r in e||r in a,get(o,n,g){if(n in a)return a[n];if(!(n in e))return;let u=e[n];if("function"==typeof u){if("function"==typeof t[n])u=l(e,e[n],t[n]);else if(s(r,n)){let t=i(n,r[n]);u=l(e,e[n],t)}else u=u.bind(e)}else if("object"==typeof u&&null!==u&&(s(t,n)||s(r,n)))u=c(u,t[n],r[n]);else{if(!s(r,"*"))return Object.defineProperty(a,n,{configurable:!0,enumerable:!0,get:()=>e[n],set(t){e[n]=t}}),u;u=c(u,t[n],r["*"])}return a[n]=u,u},set:(t,r,o,n)=>(r in a?a[r]=o:e[r]=o,!0),defineProperty:(e,t,r)=>Reflect.defineProperty(a,t,r),deleteProperty:(e,t)=>Reflect.deleteProperty(a,t)})},g=e=>({addListener(t,r,...a){t.addListener(e.get(r),...a)},hasListener:(t,r)=>t.hasListener(e.get(r)),removeListener(t,r){t.removeListener(e.get(r))}}),u=new r(e=>"function"!=typeof e?e:function(t){let r=c(t,{},{getContent:{minArgs:0,maxArgs:0}});e(r)}),m=new r(e=>"function"!=typeof e?e:function(t,r,o){let n,i,l=!1,s=new Promise(e=>{n=function(t){l=!0,e(t)}});try{i=e(t,r,n)}catch(e){i=Promise.reject(e)}let c=!0!==i&&a(i);return(!0===i||!!c||!!l)&&((e=>{e.then(e=>{o(e)},e=>{o({__mozWebExtensionPolyfillReject__:!0,message:e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred"})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})})(c?i:s),!0)}),p=({reject:t,resolve:r},a)=>{e.runtime.lastError?"The message port closed before a response was received."===e.runtime.lastError.message?r():t(Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?t(Error(a.message)):r(a)},d=(e,t,r,...a)=>{if(a.length<t.minArgs)throw Error(`Expected at least ${t.minArgs} ${n(t.minArgs)} for ${e}(), got ${a.length}`);if(a.length>t.maxArgs)throw Error(`Expected at most ${t.maxArgs} ${n(t.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((e,t)=>{let o=p.bind(null,{resolve:e,reject:t});a.push(o),r.sendMessage(...a)})},h={devtools:{network:{onRequestFinished:g(u)}},runtime:{onMessage:g(m),onMessageExternal:g(m),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},f={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return t.privacy={network:{"*":f},services:{"*":f},websites:{"*":f}},c(e,h,t)})(chrome)},"function"==typeof e&&e.amd?e("webextension-polyfill",["module"],o):o(r)},{}],kmzlN:[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");async function o(e){try{let t=await chrome.storage.local.get("password"),r=t.password?.replace(/\"/g,"")||"",a=["Black","Blue","Brown","Gold","Green","Gray","Pink","Purple","Red","Silver","White"],o=`
You are an expert vehicle classifier that extracts structured attributes from vehicle descriptions.
Return ONLY a valid JSON object in this exact format with proper quotes:

{
  "body_style": "Sedan",
  "exterior_color": "White", 
  "interior_color": "Black",
  "fuel_type": "Gasoline"
}

CRITICAL: All property names and string values MUST be wrapped in double quotes for valid JSON.

Allowed values:
- body_style: Sedan | Truck | SUV | Coupe | Convertible | Hatchback | Wagon | Minivan | Small Car | Other
- exterior_color: ${a.join(" | ")}
- interior_color: ${a.join(" | ")}
- fuel_type: Gasoline | Diesel | Electric | Hybrid

BODY STYLE CLASSIFICATION RULES (make educated guesses, avoid "Other"):
- Look for keywords: "SUV" \u2192 "SUV", "truck" \u2192 "Truck", "van" \u2192 "Minivan"
- "4-door sedan" \u2192 "Sedan", "2-door" \u2192 "Coupe", "hatchback" \u2192 "Hatchback"
- "wagon" or "estate" \u2192 "Wagon", "convertible" \u2192 "Convertible"
- "compact" or "small car" \u2192 "Small Car"
- If it mentions "4x4", "off-road", "high clearance" \u2192 likely "SUV" or "Truck"
- If it mentions "passenger capacity" or "seating" \u2192 likely "Minivan" or "SUV"
- Use context clues from vehicle model names (e.g., "F-150" \u2192 "Truck", "CR-V" \u2192 "SUV")
- ONLY use "Other" if you truly cannot determine the body style

FUEL TYPE CLASSIFICATION RULES:
- Look for: "electric", "EV", "battery" \u2192 "Electric"
- "hybrid", "HEV", "PHEV" \u2192 "Hybrid" 
- "diesel" \u2192 "Diesel"
- Any mention of "cylinders", "gasoline", "petrol", "gas", "V6", "V8", etc. \u2192 "Gasoline"
- Default to "Gasoline" if unclear

COLOR RULES:
- Always pick the closest allowed color (e.g., "Platinum White Pearl" \u2192 "White", "Maroon" \u2192 "Red").
- If interior color not mentioned, default to "Black"

IMPORTANT: Make educated guesses based on context. Only use fallback defaults if absolutely necessary.
Do not include any text outside the JSON.
Ensure all strings are properly quoted with double quotes.
`,n=await fetch("https://sag.gemquery.com/api/v1/generate-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:r,system_prompt:o,user_prompt:e,model:"gpt-4o-mini",max_tokens:200})}).then(e=>e.json());if(n.success)try{let e=n.text_response.trim();e=e.replace(/(\w+):/g,'"$1":').replace(/:\s*([A-Za-z][A-Za-z\s]*[A-Za-z])\s*([,}])/g,': "$1"$2').replace(/:\s*([A-Za-z][A-Za-z]*)\s*([,}])/g,': "$1"$2');let t=JSON.parse(e);return t}catch(e){console.error("[UnifiedAI] JSON parse error:",e,n.text_response),console.error("[UnifiedAI] Attempted to clean response:",n.text_response.trim())}else console.error("[UnifiedAI] API error:",n.error)}catch(e){console.error("[UnifiedAI] Error during API call:",e)}let t=e.toLowerCase(),r="Other";t.includes("suv")||t.includes("4x4")||t.includes("crossover")?r="SUV":t.includes("truck")||t.includes("pickup")?r="Truck":t.includes("van")||t.includes("minivan")?r="Minivan":t.includes("sedan")||t.includes("4-door")?r="Sedan":t.includes("coupe")||t.includes("2-door")?r="Coupe":t.includes("hatchback")?r="Hatchback":t.includes("convertible")?r="Convertible":t.includes("wagon")||t.includes("estate")?r="Wagon":(t.includes("compact")||t.includes("small"))&&(r="Small Car");let a="Gasoline";return t.includes("electric")||t.includes("ev")||t.includes("battery")?a="Electric":t.includes("hybrid")||t.includes("hev")||t.includes("phev")?a="Hybrid":t.includes("diesel")&&(a="Diesel"),{body_style:r,exterior_color:"Black",interior_color:"Black",fuel_type:a}}a.defineInteropFlag(r),a.export(r,"extractAttributesFromDescription",()=>o)},{"@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],"1AesJ":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"AIDescription",()=>l),a.export(r,"generateAIDescription",()=>i);var o=e("./aiAttributes"),n=e("./helping");async function i(e){try{let t,r;let a=await chrome.storage.local.get("description"),o=a?.description||"";o=o.replace(/\"/g,"").trim();let i=o&&o.length>0;t=i?`You are a vehicle listing writer for Facebook Marketplace.

CRITICAL: Follow the user's instructions EXACTLY. They override everything else.

USER INSTRUCTIONS:
${o}

VEHICLE DATA:
${e}

RULES:
- Follow user instructions FIRST
- If user says "use bullet points" \u2192 use bullet points
- If user mentions a salesman name \u2192 include that name
- Keep it clean and professional
- NO emojis unless requested

Write the description following user instructions.`:`You are a vehicle listing writer. Write a clean, professional description.

EXACT FORMAT TO FOLLOW:

[Year] [Make] [Model].

[One paragraph - 4-5 sentences. Include: mileage, color, price, condition, and one or two appealing features. Keep it professional but not overly salesy.]

Contact us for more information.

EXAMPLE OUTPUT:
2024 Toyota Camry SE.

This well-maintained vehicle has 25,000 miles and features a sleek Silver exterior with a comfortable Black interior. Powered by a reliable 2.5L engine, it delivers great fuel efficiency and a smooth ride. Priced at $24,500, this Camry is in excellent condition and ready for its next owner. Don't miss out on this great opportunity.

Contact us for more information.

RULES:
- First line: Year Make Model with a period
- Second section: ONE paragraph (4-5 sentences)
- Last line: Simple call to action
- NO bullet points
- Keep it professional but not over-the-top marketing
- NO repeating the same information twice
- Around 60-80 words for the paragraph
- Be factual with light appeal

VEHICLE DATA:
${e}

Write now.`;let l=await chrome.storage.local.get("password"),s=l.password?.replace(/\"/g,"")||"";try{r=await (0,n.fetchJson)("https://sag.gemquery.com/api/v1/generate-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:s,system_prompt:t,user_prompt:i?"Write the description following my instructions.":"Write the description.",model:"gpt-4o-mini",max_tokens:250})})}catch(e){return console.error("[AI] fetchJson error:",e),""}if(!r||!r.success)return console.error("[AI] Failed to generate description:",r?.error||"Unknown error"),"";{let e=r.text_response?.trim()||"";return e}}catch(e){return console.error("[AI] Error during API call:",e),""}}async function l(e){let t=await (0,o.extractAttributesFromDescription)(e);return t||""}},{"./aiAttributes":"kmzlN","./helping":"eBThj","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],eBThj:[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"applyCropToBlob",()=>N),a.export(r,"fetchJson",()=>U),a.export(r,"cleanSellerDesc",()=>O),a.export(r,"cleanTextForGroup",()=>E),a.export(r,"parsePrice",()=>I),a.export(r,"SaveWebsiteInfoInLocal",()=>P),a.export(r,"filterAllowedSites",()=>$),a.export(r,"sanitizeVehiclesData",()=>T),a.export(r,"listVehicleOnLocalStorage",()=>g),a.export(r,"checkVehicles",()=>s),a.export(r,"syncClientData",()=>l),a.export(r,"csvJSON",()=>n),a.export(r,"getPostedVehicles",()=>i),a.export(r,"listVehicleOnServer",()=>c),a.export(r,"cleanString",()=>h),a.export(r,"getPreviousPostedVehiclesFromLocalStorage",()=>f),a.export(r,"getWhereToPostData",()=>y),a.export(r,"getGroupUrl",()=>w),a.export(r,"getAlreadyAddedGroups",()=>A),a.export(r,"checkIfAdded",()=>b),a.export(r,"SaveFbGroup",()=>k),a.export(r,"SaveGroupsData",()=>C),a.export(r,"saveFbGroupsOnServer",()=>M),a.export(r,"extractGroupTitle",()=>x),a.export(r,"validateGroupData",()=>v),a.export(r,"enterText",()=>p),a.export(r,"findDivWithText",()=>m),a.export(r,"uploadImagesFbGroups",()=>S),a.export(r,"uploadImagesFbEvent",()=>d),a.export(r,"updateVehiclePrice",()=>u);var o=e("~common/browserMethods");function n(e){try{if(!e||"string"!=typeof e)throw Error("Invalid CSV input. Expected a non-empty string.");let t=e.split("\n");if(t.length<2)throw Error("CSV data must have at least one header row and one data row.");let r=[],a=t[0]?.split(",");if(!a||0===a.length)throw Error("CSV header row is missing or invalid.");for(let e=1;e<t.length;e++){let o=t[e];if(!o)continue;let n={},i=[],l=0,s=!1;for(let e=0;e<o.length;e++)'"'===o[e]?s=!s:","!==o[e]||s||(i.push(o.substring(l,e)),l=e+1);i.push(o.substring(l));for(let e=0;e<a.length;e++)i[e]?.startsWith('"')&&i[e]?.endsWith('"')&&(i[e]=i[e].slice(1,-1)),n[a[e]]=i[e]||null;r.push(n)}return r}catch(e){return console.error("Error parsing CSV:",e.message),[]}}let i=async()=>{let e=[],t=await chrome.storage.local.get("already_posted_vehicles");t&&t?.already_posted_vehicles&&(e=t?.already_posted_vehicles);let r=e.map(e=>e?.vin);return r};async function l(){let e=await chrome.storage.local.get("password"),t=e?.password?.replace(/\"/g,""),r=await fetch("https://sag.gemquery.com/api/v1/get-client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:t})}),a=await r.json();return a}function s(e,t){return t.map(t=>{let r=t.VIN,a=t.Title,o=e?.some(e=>e===r||e===a);return{...t,Button:o?"Post Again":"Post"}})}async function c(e,t,r){let a=await chrome.storage.local.get("password"),o=a?.password?.replace(/\"/g,""),n=await chrome.storage.local.get("salesManName"),i=n?.salesManName?.replace(/\"/g,"");i||(i="Unknown");let l={api_key:o,type:"listed_vehicle",vin:r,vehicle_url:e,listed_at:t,salesman_name:i};try{let e=await fetch("https://sag.gemquery.com/webhook/automotive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}),t=await e.json();console.log(t,`Vehicle ${r} listed on server successfully`)}catch(e){console.error(e)}}async function g(e,t,r,a=null){let o=await chrome.storage.local.get("salesManName"),n=o?.salesManName?.replace(/\"/g,"");n||(n="Unknown");let i=await chrome.storage.local.get("already_posted_vehicles"),l=[];l=i&&i?.already_posted_vehicles?i?.already_posted_vehicles:[],l?.push({vehicle_url:e,listed_at:t,vin:r,stock_number:a,salesman_name:n,price:null}),await chrome.storage.local.set({already_posted_vehicles:l});let s=await chrome.storage.local.get("soldVehicles"),c=[];s&&s?.soldVehicles&&(c=s?.soldVehicles),c?.push({vehicle_url:e,listed_at:t,vin:r,stock_number:a,salesman_name:n,price:null}),await chrome.storage.local.set({soldVehicles:c}),console.log(`Vehicle ${r} listed on local storage successfully`)}async function u(e,t){try{let r=await chrome.storage.local.get("already_posted_vehicles"),a=r?.already_posted_vehicles||[];a=a.map(r=>r.vin===e?{...r,price:t}:r),await chrome.storage.local.set({already_posted_vehicles:a});let o=await chrome.storage.local.get("soldVehicles"),n=o?.soldVehicles||[];n=n.map(r=>r.vin===e?{...r,price:t}:r),await chrome.storage.local.set({soldVehicles:n}),console.log(`Price updated for vehicle ${e}: ${t}`)}catch(e){console.error("Error updating vehicle price:",e)}}function m(e){for(let t=0;t<e?.length;t++){let r=e[t]?.textContent||e[t]?.innerText||"";if(r?.trim()==="Photo/video")return e[t]}return null}let p=(e,t)=>{e?.focus(),document.execCommand("insertText",!1,t)};async function d(e){try{let t=new DataTransfer;for(let r of e){let e=await (0,o.runTimeMessage)({message:"SET_BLOB_FROM_URL",data:{imageUrl:r}}),a=await fetch(e?.data);if(!a.ok){console.log("Failed to fetch image:",a);continue}let n=await a.blob(),i=new File([n],`${+new Date}.jpg`,{type:"image/webp"});console.log("Image uploaded successfully",i.size),t.items.add(i),await (0,o.asyncSleep)(.1)}await new Promise(e=>setTimeout(e,100));let r=document.querySelectorAll('input[type="file"]'),a=r[1];console.log(a,"fileInput"),a.files=t.files,a.dispatchEvent(new Event("change",{bubbles:!0})),console.log("Images uploaded successfully")}catch(e){console.error("Error uploading images:",e)}}let h=e=>{try{return e?.replace(/\\|"|\\r/g,"")}catch(e){return console.error("Error cleaning string:",e),""}},f=async()=>{let e=[],t=await chrome.storage.local.get("already_posted_vehicles");t&&t?.already_posted_vehicles&&(e=t?.already_posted_vehicles);let r=e.map(e=>e?.vehicle_url);return r};async function y(){let e,t;let r=await chrome.storage.local.get("facebookGroup"),a=await chrome.storage.local.get("whereToPost");r&&(e=r?.facebookGroup?.replace(/\"/g,"")),a&&(t=a?.whereToPost?.replace(/\"/g,""));let o={facebookGroup:e,whereToPost:t};return o}async function w(e){let t=await chrome.storage.local.get("facebook_groups")||[];if(0===Object.keys(t).length)return"Group title not found";for(let r of t?.facebook_groups)if(r?.name===e)return r?.url;return"Group title not found"}async function A(){let e=await chrome.storage.local.get("facebook_groups");if(Object?.keys(e)?.length===0)return[];let t=e?.facebook_groups,r=t?.map(e=>e.url);return r}async function b(e,t){let r=e.element,a=r.querySelector("a"),o=a?a.href:r?.href?.trim()?.replace('"',"")?.replace('"',"");try{let e=await A();t(e.includes(o))}catch(e){console.error("Error checking if vehicle was posted:",e)}}function x(e){try{if(!e||"string"!=typeof e)throw Error("Invalid text input");let t=e?.split("\n"),r=t?.filter(e=>{let t=e?.trim();return!t?.toLowerCase()?.startsWith("view")&&!t?.toLowerCase()?.endsWith("ago")&&t.length>0}),a=r?.join(" ")?.trim();if(!a||a.length<3)throw Error("Group title too short or empty");let o=a?.replace("You","")?.replace("you","")?.replace("last","")?.replace("Last","")?.replace("visited","")?.replace("visit","")?.replace("Visit","")?.replace("Visited","")?.replace("have","")?.replace("had","")?.replace("weeks","")?.replace("week","")?.replace("ago","")?.replace(/\b[1-9]\b/g,"")?.trim();if(!o||o.length<3)throw Error("Group title too short after cleaning");return o}catch(e){throw console.error("An error occurred while extracting the title:",e),Error("Unable to extract valid group title")}}function v(e,t){try{if(!e||"string"!=typeof e)return{isValid:!1,error:"Invalid group URL"};if(!e.includes("facebook.com/groups/"))return{isValid:!1,error:"URL must be a Facebook group URL"};if(!t||"string"!=typeof t)return{isValid:!1,error:"Invalid group title"};if(t.length<3)return{isValid:!1,error:"Group title must be at least 3 characters long"};if(t.length>100)return{isValid:!1,error:"Group title must be less than 100 characters"};return{isValid:!0}}catch(e){return{isValid:!1,error:"Validation error"}}}async function k(e){await chrome.storage.local.set({facebookGroup:e})}async function C(e){let t=await chrome.storage.local.get("groupsData");if(0===Object.keys(t).length)await chrome.storage.local.set({groupsData:[e]});else{let r=t.groupsData,a=Array.from(new Set([...r,e]));await chrome.storage.local.set({groupsData:a})}}async function M(e,t){let r=await chrome.storage.local.get("password"),a=r?.password?.replace(/\"/g,"");if(!a)throw Error("No API key found. Please authenticate first.");if(!e||!t)throw Error("Invalid group data provided");if(!e.includes("facebook.com/groups/"))throw Error("Invalid Facebook group URL format");try{let r=await fetch("https://sag.gemquery.com/webhook/automotive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({api_key:a,type:"facebook_group_add",facebook_group_name:t,facebook_group_url:e})});if(!r.ok)throw Error(`Server error: ${r.status} ${r.statusText}`);let o=await r.json();if(console.log(o,"data"),o.error)throw Error(o.error);return o}catch(e){throw console.error("Error saving group to server:",e),e}}function T(e){if(!Array.isArray(e))return console.error("Input must be an array."),[];let t=/\s+/g,r=/\D/g;return e.map(e=>{let a={};for(let[o,n]of Object.entries(e)){if(null==n)continue;let e=o.trim().replace(t,""),i=n;if("string"!=typeof i||""!==i.trim()){if("string"==typeof i&&(i=i.trim().replace(t," ")),"imageurls"===e.toLowerCase()){"string"==typeof i?a.ImageUrls=i.split(";").map(e=>e.trim()).filter(Boolean):Array.isArray(i)?a.ImageUrls=i.map(e=>"string"==typeof e?e.trim():"").filter(Boolean):a.ImageUrls=[];continue}if("mileagevalue"===e.toLowerCase()){a.MileageValue="string"==typeof i?parseInt(i.replace(r,""))||0:"number"==typeof i?i:0;continue}if("trim"===e.toLowerCase()){try{"string"==typeof i&&""!==i.trim()?a.Trim=i.trim().replace(t," "):a.Trim=""}catch(e){console.warn("Error processing Trim field:",e),a.Trim=""}continue}if("engine"===e.toLowerCase()){try{if("string"==typeof i&&""!==i.trim()){let e=i.trim().replace(/\s+/g," ").replace(/\r\n|\r|\n/g,"").trim();a.engine=e}else"number"==typeof i?a.engine=i.toString()+"L":a.engine=""}catch(e){console.warn("Error processing engine field:",e),a.engine=""}continue}a[e]=i}}return a})}function E(e){if(!e)return"";let t=e.includes("\u2022")||e.includes("\n\u2022")||e.includes("Body Style:")&&e.includes("Color:")||e.includes("Engine:")||e.includes("Exterior Color:");if(t){let t=e.replace(/\\n/g,"\n").replace(/\n\s+/g,"\n").replace(/\s+(?=\n)/g,"").replace(/\s{2,}/g," ").trim();return(t=t.replace(/\u2022\s*/g,"\n\u2022 ").replace(/^\n+/,"").replace(/\n{3,}/g,"\n\n")).replace(/::/g,":")}let r=e.replace(/\\n/g," ").replace(/\n/g," ");r=(r=(r=r.replace(/[^a-zA-Z0-9.,!? ]/g,"")).replace(/\s+/g," ").trim()).toLowerCase().replace(/(^\s*[a-z])|([.!?]\s*[a-z])/g,e=>e.toUpperCase());let a=r.split(" ");return a.length>200&&(r=a.slice(0,200).join(" ")),r}async function S(e){try{if(!e||0===e.length){console.warn("No image URLs provided");return}console.log(e,"imageUrls");let{insertableVehicleData:t}=await chrome.storage.local.get("insertableVehicleData"),r=t?.cropSettings,a=null,n=new DataTransfer,i=0;for(let t=0;t<e.length;t++){let a=e[t];if(!a||"string"!=typeof a){console.warn(`Skipping invalid image URL at index ${t}:`,a);continue}let l=0,s=!1;for(;l<2&&!s;)try{let l=await (0,o.runTimeMessage)({message:"SET_BLOB_FROM_URL",data:{imageUrl:a}});if(!l?.data)throw Error("No blob data received from background script");let c=await fetch(l.data);if(!c.ok)throw Error(`Failed to fetch blob: ${c.status} ${c.statusText}`);let g=await c.blob();if(r){let e=r.perImage?.[t]||r.default;e&&(console.log(`Applying crop to FB Groups image ${t}:`,e),g=await N(g,e))}if(!g||0===g.size)throw Error("Empty or invalid blob data");if(g.size>4194304){console.warn(`Skipping image ${t+1}/${e.length}: Size ${(g.size/1024/1024).toFixed(2)}MB exceeds 4MB limit`),s=!0;continue}let u=Date.now(),m=Math.random().toString(36).substr(2,9),p=`image_${u}_${m}.jpg`,d=new File([g],p,{type:"image/jpeg",lastModified:u});n.items.add(d),i++,s=!0,console.log(`Successfully processed image ${t+1}/${e.length} (${(g.size/1024).toFixed(2)}KB)`),await (0,o.asyncSleep)(.1)}catch(r){l++,console.warn(`Attempt ${l}/2 failed for image ${t+1}:`,r.message),l<2?await (0,o.asyncSleep)(.5*Math.pow(2,l)):(console.error(`Failed to process image ${t+1}/${e.length} after 2 attempts:`,r),s=!0)}}if(0===i){console.error("No images were successfully processed");return}if(console.log(`Successfully processed ${i}/${e.length} images`),!(a=await _())){console.error("Could not find any file input element");return}try{for(let e of(a.files=n.files,["change","input"])){let t=new Event(e,{bubbles:!0,cancelable:!0});a.dispatchEvent(t),await (0,o.asyncSleep)(.05)}console.log(`Upload triggered successfully with ${n.files.length} files`)}catch(e){throw console.error("Error triggering file upload:",e),e}}catch(e){throw console.error("Critical error in uploadImagesFbGroups:",e),e}}async function _(){let e=[()=>{let e=document.querySelector('[role="dialog"] form');return e?.querySelector('input[type="file"]')},()=>{let e=document.querySelectorAll('input[type="file"]');for(let t of e){let e=window.getComputedStyle(t);if("none"!==e.display&&"hidden"!==e.visibility)return t}return null},()=>{let e=document.querySelectorAll('input[type="file"]');return e.length>0?e[0]:null},async()=>{await (0,o.asyncSleep)(.5);let e=document.querySelectorAll('input[type="file"]');return e.length>0?e[0]:null}];for(let t=0;t<e.length;t++)try{let r=await e[t]();if(r)return console.log(`File input found using strategy ${t+1}`),r}catch(e){console.warn(`Strategy ${t+1} failed:`,e.message)}return null}function $(e,t){try{if(!Array.isArray(e))throw Error("allowedWebsites must be an array");if(!Array.isArray(t))throw Error("allSitesData must be an array");return t.filter(t=>e.includes(t?.website_url))}catch(e){return console.error("Error in filterAllowedSites:",e),[]}}async function P(e,t){try{let r=e?.split(",")?.map(e=>e?.trim());await chrome.storage.local.set({allowedWebsites:r});let a=await fetch("https://sag.gemquery.com/api/v1/get-website"),o=await a.json(),n=$(r,o.websites);"hamzamaqbool@gmail.com"==t?await chrome.storage.local.set({siteDetails:o.websites}):await chrome.storage.local.set({siteDetails:n})}catch(e){console.error(e)}}let I=e=>{if(!e)return 0;let t=e.replace(/C\$|CAD\$|\$|\u20ac|\u00a3|\u20b9|\u00a5|\u20a9|\u20b1|\u20bd/g,"").replace(/,/g,"").replace(/\s+/g,"").replace(/[^\d.-]/g,"");t.includes("-")&&(t=t.split("-")[0]),(t.includes("/mo")||t.includes("/month"))&&(t=t.replace(/\/mo.*|\/month.*/,""));let r=parseFloat(t);return isNaN(r)?0:r};function O(e){if(!e)return"";let t=e.replace(/\\n/g,"\n"),r=t.replace(/\s+/g," "),a=r.replace(/\n+/g,"\n").trim();return a}async function U(e,t){let r=await fetch(e,t);if(!r.ok)throw Error(`HTTP error! status: ${r.status}`);return await r.json()}async function N(e,t){try{if(!t||0===t.top&&0===t.bottom&&0===t.left&&0===t.right)return e;let r=new Image,a=URL.createObjectURL(e);await new Promise((e,t)=>{r.onload=e,r.onerror=t,r.src=a});let o=document.createElement("canvas"),n=o.getContext("2d");if(!n)return console.error("Failed to get canvas context"),e;let i=r.height*t.top/100,l=r.height*t.bottom/100,s=r.width*t.left/100,c=r.width*t.right/100,g=r.width-s-c,u=r.height-i-l;return o.width=g,o.height=u,n.drawImage(r,s,i,g,u,0,0,g,u),URL.revokeObjectURL(a),new Promise((t,r)=>{o.toBlob(a=>{a?(console.log(`Image cropped successfully. Original: ${(e.size/1024).toFixed(2)}KB, Cropped: ${(a.size/1024).toFixed(2)}KB`),t(a)):r(Error("Failed to create cropped blob"))},"image/jpeg",.9)})}catch(t){return console.error("Error applying crop to blob:",t),e}}},{"~common/browserMethods":"92Ssc","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],"138GT":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"uploadImagesFbEvent",()=>m);var o=e("./imageProcessing");function n(e){return new Promise(t=>setTimeout(t,1e3*e))}async function i(e){try{let t=await chrome.runtime.sendMessage(e);return t}catch(e){throw console.error("Runtime message error:",e),e}}async function l(){try{let{customInputDelaySeconds:e}=await chrome.storage.local.get("customInputDelaySeconds");await n(e||.5)}catch(e){await n(.5)}}async function s(e=.3){await n(e+.2*Math.random())}async function c(){let e=Math.random();e<.05?await n(3+2*Math.random()):e<.15&&await n(1.5+1.5*Math.random())}async function g(){await n(.8+1.7*Math.random())}async function u(e=5e3){let t=Date.now();for(;Date.now()-t<e;){let e=document.querySelectorAll('[role="img"][aria-label*="photo"], [data-testid*="photo"], img[src*="scontent"]');if(e.length>0)return!0;await n(.2)}return!1}async function m(e){try{let t=async(e,t,r)=>new Promise((a,o)=>{let n=setTimeout(()=>o(Error(`${r} timeout`)),t);e.then(e=>{clearTimeout(n),a(e)}).catch(e=>{clearTimeout(n),o(e)})}),r=async(e,t)=>{let r=new AbortController,a=setTimeout(()=>r.abort(),t);try{let t=await fetch(e,{signal:r.signal});return t}finally{clearTimeout(a)}},a=async()=>{let e=[async()=>{let e=document.querySelector('[role="dialog"] form');return e?.querySelector('input[type="file"]')||null},async()=>{let e=document.querySelectorAll('input[type="file"]');for(let t of e){let e=window.getComputedStyle(t);if("none"!==e.display&&"hidden"!==e.visibility)return t}return null},async()=>{let e=document.querySelectorAll('input[type="file"]');return e[0]||null},async()=>{await n(.3);let e=document.querySelectorAll('input[type="file"]');return e[0]||null}];for(let t of e)try{let e=await t();if(e)return e}catch(e){}return null},m=await a();if(!m)throw Error("No file input found");let{insertableVehicleData:p}=await chrome.storage.local.get("insertableVehicleData"),d=p?.cropSettings,h=Array.isArray(e)?e.slice(0,20):[],f=(0,o.pickDeviceProfile)(),y=(0,o.recentTimestamp)();for(let e=0;e<h.length;e++){let a=h[e];try{e>0&&await g();let p=await t(i({message:"SET_BLOB_FROM_URL",data:{imageUrl:a}}),6e3,"blob-request");if(!p?.success||!p?.data)throw Error(p?.error||"no-blob-data");let w=await r(p.data,8e3);if(!w.ok)throw Error("blob-fetch-failed");let A=await w.blob(),b=d?.perImage?.[e]||d?.default,x=await (0,o.processImageBlob)(A,{manualCrop:b,deviceProfile:f,timestamp:new Date(y.getTime()+6e4*e)});if(x.size>4194304){console.warn(`Skipping image ${e+1}/${h.length}: Size ${(x.size/1024/1024).toFixed(2)}MB exceeds 4MB limit`);continue}await s(.2);let v=new DataTransfer;v.items.add(x),m.files=v.files;let k=["change","input"];for(let e of k)m.dispatchEvent(new Event(e,{bubbles:!0,cancelable:!0})),await s(.05);await u(5e3),await l(),await c(),(e+1)%5==0&&e+1<h.length&&await n(.5+1.5*Math.random())}catch(t){console.warn(`Error processing/uploading image ${e+1}:`,a,t),await n(.5)}}}catch(e){throw console.error("Error in uploadImagesFbEvent:",e),e}}},{"./imageProcessing":"1HGuv","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],"1HGuv":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"processImageBlob",()=>s),a.export(r,"pickDeviceProfile",()=>n),a.export(r,"recentTimestamp",()=>i);let o=[{make:"Apple",model:"iPhone 14 Pro",software:"iOS 17.0"},{make:"Apple",model:"iPhone 13",software:"iOS 16.5"},{make:"Samsung",model:"SM-S918B",software:"Android 13"},{make:"Google",model:"Pixel 7 Pro",software:"Android 13"},{make:"Apple",model:"iPhone 12",software:"iOS 15.7"},{make:"Samsung",model:"SM-G998B",software:"Android 12"},{make:"OnePlus",model:"ONEPLUS A6000",software:"Android 12"},{make:"Xiaomi",model:"Mi 11",software:"Android 12"}];function n(){return o[Math.floor(Math.random()*o.length)]}function i(){let e=Date.now(),t=e-2592e6;return new Date(t+Math.random()*(e-t))}function l(e,t){return Math.random()*(t-e)+e}async function s(e,t){try{let r;let a=URL.createObjectURL(e),o=await new Promise((e,t)=>{let r=new Image;r.onload=()=>e(r),r.onerror=t,r.src=a}),s=function(e,t){let r=0,a=0,o=0,n=0;t&&(r=e.height*t.top/100,a=e.height*t.bottom/100,o=e.width*t.left/100,n=e.width*t.right/100);let i=e.height*l(0,.01)/100,s=e.height*l(0,.01)/100,c=e.width*l(0,.01)/100,g=e.width*l(0,.01)/100,u=r+i,m=a+s,p=o+c,d=n+g,h=e.width-p-d,f=e.height-u-m;return{sourceX:p,sourceY:u,sourceWidth:h,sourceHeight:f,canvasWidth:h,canvasHeight:f}}(o,t?.manualCrop),c=function(e,t){let r=[3024,2732,2448,2048,1920,1600],a=r[Math.floor(Math.random()*(r.length-1-0+1))+0],o=Math.max(e,t);if(o<=a){let r=l(.95,1);return{width:Math.round(e*r),height:Math.round(t*r)}}let n=a/o,i=Math.round(o*n),s=Math.round(Math.min(e,t)*n);return e>t?{width:i,height:s}:{width:s,height:i}}(s.canvasWidth,s.canvasHeight),g=document.createElement("canvas");g.width=c.width,g.height=c.height;let u=g.getContext("2d");if(!u)throw Error("Failed to get canvas context");(function(e,t,r){let a=l(-.25,.25);e.translate(t/2,r/2),e.rotate(a*Math.PI/180),e.translate(-t/2,-r/2)})(u,c.width,c.height),u.drawImage(o,s.sourceX,s.sourceY,s.sourceWidth,s.sourceHeight,0,0,c.width,c.height);let m=u.getImageData(0,0,c.width,c.height);(function(e,t){let r=t.data,a=l(-.02,.02),o=l(-.01,.01);for(let e=0;e<r.length;e+=4){r[e]=Math.min(255,Math.max(0,r[e]+255*a)),r[e+1]=Math.min(255,Math.max(0,r[e+1]+255*a)),r[e+2]=Math.min(255,Math.max(0,r[e+2]+255*a));let t=259*(255+255*o)/(255*(259-255*o));r[e]=Math.min(255,Math.max(0,t*(r[e]-128)+128)),r[e+1]=Math.min(255,Math.max(0,t*(r[e+1]-128)+128)),r[e+2]=Math.min(255,Math.max(0,t*(r[e+2]-128)+128))}e.putImageData(t,0,0)})(u,m),function(e,t,r){let a=e.getImageData(0,0,t,r),o=a.data,n=l(.5,1.5);for(let e=0;e<o.length;e+=4){let t=(Math.random()-.5)*n;o[e]=Math.min(255,Math.max(0,o[e]+t)),o[e+1]=Math.min(255,Math.max(0,o[e+1]+t)),o[e+2]=Math.min(255,Math.max(0,o[e+2]+t))}e.putImageData(a,0,0)}(u,c.width,c.height);let p=l(.75,.95),d=await new Promise(e=>{g.toBlob(t=>e(t),"image/jpeg",p)});if(URL.revokeObjectURL(a),!d)throw Error("Failed to create processed blob");let h=t?.deviceProfile||n(),f=t?.timestamp||i(),y=await d.arrayBuffer(),w=function(e,t,r,a){let o=e=>e.toString().padStart(2,"0"),n=`${t.getFullYear()}:${o(t.getMonth()+1)}:${o(t.getDate())} ${o(t.getHours())}:${o(t.getMinutes())}:${o(t.getSeconds())}`,i=e=>{let t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return t.push(0),t},l=e=>[e>>8&255,255&e],s=e=>[e>>24&255,e>>16&255,e>>8&255,255&e],c=[];c.push(77,77),c.push(0,42),c.push(0,0,0,8);let g=[],u=86,m=[],p=i(e.make);g.push({tag:271,type:2,count:p.length,value:p.length<=4?[...p,...Array(4-p.length).fill(0)]:s(u)}),p.length>4&&(m.push(...p),u+=p.length);let d=i(e.model);g.push({tag:272,type:2,count:d.length,value:d.length<=4?[...d,...Array(4-d.length).fill(0)]:s(u)}),d.length>4&&(m.push(...d),u+=d.length);let h=i(e.software);g.push({tag:305,type:2,count:h.length,value:h.length<=4?[...h,...Array(4-h.length).fill(0)]:s(u)}),h.length>4&&(m.push(...h),u+=h.length);let f=i(n);for(let e of(g.push({tag:306,type:2,count:f.length,value:s(u)}),m.push(...f),u+=f.length,g.push({tag:274,type:3,count:1,value:[0,1,0,0]}),g.push({tag:282,type:5,count:1,value:s(u)}),m.push(...s(72),...s(1)),u+=8,c.push(...l(g.length)),g))c.push(...l(e.tag)),c.push(...l(e.type)),c.push(...s(e.count)),c.push(...e.value);return c.push(0,0,0,0),c.push(...m),new Uint8Array(c)}(h,f,c.width,c.height),A=function(e,t){let r=new Uint8Array(e);if(255!==r[0]||216!==r[1])return console.warn("Not a valid JPEG, returning original"),e;let a=[69,120,105,102,0,0],o=2+a.length+t.length,n=new Uint8Array(4+a.length+t.length);n[0]=255,n[1]=225,n[2]=o>>8&255,n[3]=255&o,n.set(a,4),n.set(t,4+a.length);let i=2;if(255===r[2]&&224===r[3]){let e=r[4]<<8|r[5];i=4+e}let l=new Uint8Array(r.length+n.length);return l.set(r.slice(0,i),0),l.set(n,i),l.set(r.slice(i),i+n.length),l.buffer}(y,w),b=f.toISOString().replace(/[:.]/g,"").slice(0,15),x=Math.random().toString(36).substring(2,6).toUpperCase();r="Apple"===h.make?`IMG_${x}.jpg`:"Samsung"===h.make?`${b}_${x}.jpg`:`IMG_${b}_${x}.jpg`;let v=new File([A],r,{type:"image/jpeg",lastModified:f.getTime()});return v}catch(r){console.error("Error processing image blob:",r);let t=new File([e],`image_${Date.now()}.jpg`,{type:"image/jpeg"});return t}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}]},["eZj0B"],"eZj0B","parcelRequire4d24"),globalThis.define=t;